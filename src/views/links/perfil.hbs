<body onload="cargarDatosDeCliente()">
  
  <div class="container" onload="cargarDatosDeCliente()">
     <div class="row">
        <div class="col-md-12">
           <div id="content" class="content content-full-width">
              <!-- begin profile -->
              <div class="profile">
                 <div class="profile-header">
                    <!-- BEGIN profile-header-cover -->
                    <div class="profile-header-cover"></div>
                    <!-- END profile-header-cover -->
                    <!-- BEGIN profile-header-content -->
                    <div class="profile-header-content">
                       <!-- BEGIN profile-header-img -->
                       <div class="profile-header-img">
                          <img src="/img/logop.png" alt="">
                       </div>
                       <!-- END profile-header-img -->
                       <!-- BEGIN profile-header-info -->
                       <div class="profile-header-info">
                          <h4 id="idnombrehtml" class="m-t-10 m-b-5"></h4>
                          <p class="m-b-10" id="dninombrehtml"></p>
                          <a href="#" class="btn btn-primary mb-2">EDITAR DATOS</a>
                       </div>
                       <!-- END profile-header-info -->
                    </div>
                    <!-- END profile-header-content -->
                    <!-- BEGIN profile-header-tab -->
                    <ul class="profile-header-tab nav nav-tabs">
                       <li class="nav-item"><a href="#" class="nav-link" onclick="cargarDatosDeCliente()">VER TODOS</a></li>
                       <li class="nav-item"><a href="#" class="nav-link" onclick="cargarDatosLegales()">EVENTOS LEGALES</a></li>
                       <li class="nav-item"><a href="#" class="nav-link" onclick="cargarDatosMedicos()">EVENTOS MEDICOS</a></li>
                       <li class="nav-item"><a href="#" class="nav-link "onclick="cargarDatosPsicologicos()">EVENTOS PSICOLOGICOS</a></li>
                    </ul>
                    <!-- END profile-header-tab -->
                 </div>
              </div>
              <!-- end profile -->
  
              <!-- begin profile-content -->
              <div class="profile-content">
                 <!-- begin tab-content -->
                 <div class="tab-content p-0">
                    <!-- begin #profile-post tab -->
                    <div class="tab-pane fade active show" id="eventosPost">
                       <!-- begin timeline -->
                       
                       <!-- end timeline -->
                    </div>
                    <!-- end #profile-post tab -->
                 </div>
                 <!-- end tab-content -->
              </div>
              <!-- end profile-content -->
           </div>
        </div>
     </div>
  </div>
</body>

<script>
  function cargarDatosLegales(){
    const allEvents = {{{dataeventos}}};
    const arrayLegales = allEvents.filter(function(evtL){
      if (evtL.diag_leg != "")
      return true
    })
    generadoraHtml(arrayLegales, "legal")
  }

  function cargarDatosMedicos(){
    const allEvents = {{{dataeventos}}};
    const arrayMedicos = allEvents.filter(function(evtM){
      if (evtM.diag_med != "")
      return true
    })
    generadoraHtml(arrayMedicos, "medico")
  }

  function cargarDatosPsicologicos(){
    const allEvents = {{{dataeventos}}};
    const arrayPsico = allEvents.filter(function(evtP){
      if (evtP.diag_psico != "")
      return true
    })
    generadoraHtml(arrayPsico, "psico")
  }


  function generadoraHtml(arrayEvt, flag){

    constructor = ""
    constructor = '<ul class="timeline">'

    for (let index = 0; index < arrayEvt.length; index++) {
      constructor += '<li><div class="timeline-time"><span class="date"></span>Fecha: <span class="time">'+arrayEvt[index].fecha_evt+'</span></div><div class="timeline-icon"><a href="">&nbsp;</a></div><div class="timeline-body">';
      if (flag == "legal" || flag == "todos"){
        constructor += '<div class="timeline-header"><span class="username"><a href="">DIAGNOSTICO LEGAL</a></span></div><div class="timeline-content"><p>'+arrayEvt[index].diag_leg+'</p><br><p>PROXIMA VISITA LEGAL: '+arrayEvt[index].fecha_prox_legal+'</p></div>'};
      if (flag == "medico" || flag == "todos"){
        constructor += '<div class="timeline-header"><span class="username"><a href="">DIAGNOSTICO MEDICO</a></span></div><div class="timeline-content"><p>'+arrayEvt[index].diag_med+'</p><br><p>PROXIMA VISITA MEDICA: '+arrayEvt[index].fecha_prox_med+'</p></div>'};
      if (flag == "psico" || flag == "todos"){
        constructor += '<div class="timeline-header"><span class="username"><a href="">DIAGNOSTICO PSICOLOGICO</a></span></div>      <div class="timeline-content"><p>'+arrayEvt[index].diag_psico+'</p><br><p>PROXIMA VISITA PSICOLOGICA: '+arrayEvt[index].fecha_prox_psico+'</p></div>'};
      constructor += '<div class="timeline-comment-box"><div class="input"><div class="input-group"><span class="input-group-btn p-l-10"><button class="btn btn-primary f-s-12 rounded-corner" type="button">EDITAR</button> Fecha de Contacto: '+arrayEvt[index].fecha_prox_contacto+' Realizado: '+arrayEvt[index].check+'</span></div></div></div></div></li>';
    }
    constructor += '</ul>'
    document.getElementById("eventosPost").innerHTML = constructor
  }

  function cargarDatosDeCliente(){ 
    const allEvents = {{{dataeventos}}};
    document.getElementById("idnombrehtml").innerHTML = allEvents[0].nombre_cliente_evt;
    document.getElementById("dninombrehtml").innerHTML = allEvents[0].dni_evt;
    generadoraHtml(allEvents,"todos")
  };

</script>